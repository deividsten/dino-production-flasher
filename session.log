--- Session Log Started: 2025-10-27 16:07:24 ---

('Firebase', 'üöÄ Starting DinoCore Production Flasher v1.2.14')
('Firebase', 'üìç Working directory: C:\\Users\\deivi\\OneDrive\\Documents\\Dino\\try 6\\cleaned_gui_flasher')
('Firebase', 'üêç Python version: 3.12.6 (tags/v3.12.6:a4a2d2b, Sep  6 2024, 20:11:23) [MSC v.1940 64 bit (AMD64)]')
('Firebase', '‚ö†Ô∏è Firebase not available')
üöÄ Starting QR Scanner Workflow - Field ready for scanning!
üì± Position QR scanner and scan toy code...
üìã Input received: https://bondu.com/toy/wrek2b
üÜî Processed Toy ID: toy_wrek2b
‚úÖ ESP32 detected on port COM21
üåê Language changed to zh_CN - refreshing all UI texts
üåê Language changed to en - refreshing all UI texts
üåê Language changed to zh_CN - refreshing all UI texts
üåê Language changed to en - refreshing all UI texts
üåê Language changed to zh_CN - refreshing all UI texts
‚úÖ Device ready on port: COM21
üéØ Using default hardware version: 1.9.1
‚úÖ ESP32 detected on port COM21
üöÄ Auto-starting Testing & eFuse flash...
--- Processing new device on COM21 ---
Attempting to burn eFuse with version 1.9.1...
Attempting to burn eFuse with version 1.9.1...
Attempting to reset device into download mode...
Device reset successful, proceeding with eFuse burning...
üåê Language changed to en - refreshing all UI texts
[OK] eFuse burned successfully.
Burn command succeeded. Verifying by reading back eFuse...
Attempting to read eFuse from COM21...
[OK] Found raw eFuse version: 1.9.1
[OK] Verification successful. Version 1.9.1 is burned.
eFuse burning completed successfully. Starting firmware flash...
-- Starting testing flash for HW 1.9.1 on COM21 --
('show_progress',)
-- Starting testing flash for HW 1.9.1 on COM21 --
Downloading testing firmware for HW 1.9.1...
Found compatible build: qc
Downloading bootloader.bin...
Downloading magical-toys.bin...
Downloading partition-table.bin...
Downloading ota_data_initial.bin...
[OK] Testing firmware for 1.9.1 downloaded successfully.
Warning: Deprecated: Option '--flash_mode' is deprecated. Use '--flash-mode' instead.
Warning: Deprecated: Option '--flash_freq' is deprecated. Use '--flash-freq' instead.
Warning: Deprecated: Option '--flash_size' is deprecated. Use '--flash-size' instead.
Warning: Deprecated: Choice 'default_reset' for option '--before' is deprecated. Use 'default-reset' instead.
Warning: Deprecated: Choice 'hard_reset' for option '--after' is deprecated. Use 'hard-reset' instead.
Warning: Deprecated: Command 'write_flash' is deprecated. Use 'write-flash' instead.
esptool v5.1.0
Serial port COM21:
Connecting...
Connected to ESP32-S3 on COM21:
Chip type:          ESP32-S3 (QFN56) (revision v0.2)
Features:           Wi-Fi, BT 5 (LE), Dual Core + LP Core, 240MHz, Embedded PSRAM 8MB (AP_3v3)
Crystal frequency:  40MHz
USB mode:           USB-Serial/JTAG
MAC:                8c:bf:ea:84:43:c0

Uploading stub flasher...
Running stub flasher...
Stub flasher running.
Changing baud rate to 460800...
Changed.

Configuring flash size...
Flash will be erased from 0x00000000 to 0x00005fff...
Flash will be erased from 0x00260000 to 0x003fafff...
Flash will be erased from 0x00010000 to 0x00010fff...
Flash will be erased from 0x00015000 to 0x00016fff...
SHA digest in image updated.
Compressed 20976 bytes to 13360...

('progress_update', 'Flashing... 0.0%')
('progress_update', 'Flashing... 100.0%')
Wrote 20976 bytes (13360 compressed) at 0x00000000 in 0.2 seconds (804.0 kbit/s).
Hash of data verified.
Compressed 1681376 bytes to 1014463...

('progress_update', 'Flashing... 0.0%')
('progress', 0)
('progress_update', 'Flashing... 1.6%')
('progress', 1)
('progress_update', 'Flashing... 3.2%')
('progress', 3)
('progress_update', 'Flashing... 4.8%')
('progress', 4)
('progress_update', 'Flashing... 6.5%')
('progress', 6)
('progress_update', 'Flashing... 8.1%')
('progress', 8)
('progress_update', 'Flashing... 9.7%')
('progress', 9)
('progress_update', 'Flashing... 11.3%')
('progress', 11)
('progress_update', 'Flashing... 12.9%')
('progress', 12)
('progress_update', 'Flashing... 14.5%')
('progress', 14)
('progress_update', 'Flashing... 16.2%')
('progress', 16)
('progress_update', 'Flashing... 17.8%')
('progress', 17)
('progress_update', 'Flashing... 19.4%')
('progress', 19)
('progress_update', 'Flashing... 21.0%')
('progress', 21)
('progress_update', 'Flashing... 22.6%')
('progress', 22)
('progress_update', 'Flashing... 24.2%')
('progress', 24)
('progress_update', 'Flashing... 25.8%')
('progress', 25)
('progress_update', 'Flashing... 27.5%')
('progress', 27)
('progress_update', 'Flashing... 29.1%')
('progress', 29)
('progress_update', 'Flashing... 30.7%')
('progress', 30)
('progress_update', 'Flashing... 32.3%')
('progress', 32)
('progress_update', 'Flashing... 33.9%')
('progress', 33)
('progress_update', 'Flashing... 35.5%')
('progress', 35)
('progress_update', 'Flashing... 37.1%')
('progress', 37)
('progress_update', 'Flashing... 38.8%')
('progress', 38)
('progress_update', 'Flashing... 40.4%')
('progress', 40)
('progress_update', 'Flashing... 42.0%')
('progress', 42)
('progress_update', 'Flashing... 43.6%')
('progress', 43)
('progress_update', 'Flashing... 45.2%')
('progress', 45)
('progress_update', 'Flashing... 46.8%')
('progress', 46)
('progress_update', 'Flashing... 48.5%')
('progress', 48)
('progress_update', 'Flashing... 50.1%')
('progress', 50)
('progress_update', 'Flashing... 51.7%')
('progress', 51)
('progress_update', 'Flashing... 53.3%')
('progress', 53)
('progress_update', 'Flashing... 54.9%')
('progress', 54)
('progress_update', 'Flashing... 56.5%')
('progress', 56)
('progress_update', 'Flashing... 58.1%')
('progress', 58)
('progress_update', 'Flashing... 59.8%')
('progress', 59)
('progress_update', 'Flashing... 61.4%')
('progress', 61)
('progress_update', 'Flashing... 63.0%')
('progress', 63)
('progress_update', 'Flashing... 64.6%')
('progress', 64)
('progress_update', 'Flashing... 66.2%')
('progress', 66)
('progress_update', 'Flashing... 67.8%')
('progress', 67)
('progress_update', 'Flashing... 69.4%')
('progress', 69)
('progress_update', 'Flashing... 71.1%')
('progress', 71)
('progress_update', 'Flashing... 72.7%')
('progress', 72)
('progress_update', 'Flashing... 74.3%')
('progress', 74)
('progress_update', 'Flashing... 75.9%')
('progress', 75)
('progress_update', 'Flashing... 77.5%')
('progress', 77)
('progress_update', 'Flashing... 79.1%')
('progress', 79)
('progress_update', 'Flashing... 80.8%')
('progress', 80)
('progress_update', 'Flashing... 82.4%')
('progress', 82)
('progress_update', 'Flashing... 84.0%')
('progress', 84)
('progress_update', 'Flashing... 85.6%')
('progress', 85)
('progress_update', 'Flashing... 87.2%')
('progress', 87)
('progress_update', 'Flashing... 88.8%')
('progress', 88)
('progress_update', 'Flashing... 90.4%')
('progress', 90)
('progress_update', 'Flashing... 92.1%')
('progress', 92)
('progress_update', 'Flashing... 93.7%')
('progress', 93)
('progress_update', 'Flashing... 95.3%')
('progress', 95)
('progress_update', 'Flashing... 96.9%')
('progress', 96)
('progress_update', 'Flashing... 98.5%')
('progress', 98)
('progress_update', 'Flashing... 100.0%')
('progress', 100)
Wrote 1681376 bytes (1014463 compressed) at 0x00260000 in 9.5 seconds (1414.5 kbit/s).
Hash of data verified.
Compressed 3072 bytes to 176...

('progress_update', 'Flashing... 0.0%')
('progress_update', 'Flashing... 100.0%')
Wrote 3072 bytes (176 compressed) at 0x00010000 in 0.0 seconds (1088.6 kbit/s).
Hash of data verified.
Compressed 8192 bytes to 31...

('progress_update', 'Flashing... 0.0%')
('progress_update', 'Flashing... 100.0%')
Wrote 8192 bytes (31 compressed) at 0x00015000 in 0.0 seconds (1982.9 kbit/s).
Hash of data verified.

Hard resetting via RTS pin...
[OK] Flash successful!
('hide_progress',)
-- Finished flashing COM21 --
Flash completed successfully. Starting serial monitor...
--- Serial monitor started for COM21 ---
I (103) esp_image: segment 2: paddr=002c0020 vaddr=42000020 sizeI (805) esp_psram: SPI SRAM memory test OK
I (813) cpu_start: Pro cpu start user code
I (814) cpu_start: cpu freq: 240000000 Hz
I (814) app_init: Application information:
I (814) app_init: Project name:     simple-speaker
I (814) app_init: App version:      0.1.2-dev
I (814) app_init: Compile time:     Sep  5 2025 13:46:33
I (814) app_init: ELF file SHA256:  e685db1b8...
I (814) app_init: ESP-IDF:          v5.4.1
I (815) efuse_init: Min chip rev:     v0.0
I (815) efuse_init: Max chip rev:     v0.99
I (815) efuse_init: Chip rev:         v0.2
I (815) heap_init: Initializing. RAM available for dynamic allocation:
I (816) heap_init: At 3FCB24C8 len 00037248 (220 KiB): RAM
I (816) heap_init: At 3FCE9710 len 00005724 (21 KiB): RAM
I (816) heap_init: At 3FCF0000 len 00008000 (32 KiB): DRAM
I (816) heap_init: At 600FE120 len 00001EC8 (7 KiB): RTCRAM
I (1044) esp_psram: Adding pool of 7808K of PSRAM memory to heap allocator
I (1045) spi_flash: detected chip: generic
I (1045) spi_flash: flash io: dio
I (1046) sleep_gpio: Configure to isolate all GPIO pins in sleep state
I (1046) sleep_gpio: Enable automatic switching of GPIO sleep configuration
I (1047) coexist: coex firmware version: e727207
I (1047) coexist: coexist rom version e7ae62f
I (1048) main_task: Started on CPU0
I (1058) esp_psram: Reserving pool of 32K of internal memory for DMA/internal allocations
I (1058) main_task: Calling app_main()
I (1058) recording_mode: Standalone recording demo app_main starting
I (1068) deep_sleep: Initializing deep sleep manager...
I (1068) deep_sleep: üîç DEBUG: NVS flash initialized successfully for deep sleep manager
I (1068) deep_sleep: üîç DEBUG: Attempting to read OTA reboot flag from NVS...
I (1068) deep_sleep: üîç DEBUG: NVS namespace 'deep_sleep' not found: ESP_ERR_NVS_NOT_FOUND (assuming no OTA reboot flag)
I (1068) deep_sleep: RTC memory invalid or first boot - initializing
I (1068) deep_sleep: Wake button GPIO1 initialized (current state: 1)
I (1068) deep_sleep: === Deep Sleep State ===
I (1068) deep_sleep: Magic number: 0xdeadbeef
I (1068) deep_sleep: First boot: true
I (1068) deep_sleep: Wake count: 0
I (1068) deep_sleep: Normal operation enabled: false
I (1068) deep_sleep: =======================
I (1068) deep_sleep: Deep sleep manager initialized successfully
I (1068) button_handler: Initializing interrupt-based button system...
I (1068) button_handler: Interrupt-based button system initialized successfully
I (1068) button_handler: Button on GPIO1 - Short press: sleep, Long press (5s): recording, Very long (10s): factory reset
I (1068) SHARED_I2C: Initializing shared I2C bus...
I (1068) SHARED_I2C: ‚úÖ Shared I2C bus initialized successfully (SCL: GPIO40, SDA: GPIO41)
I (1068) BATTERY_MONITOR: Initializing battery monitoring system...
I (1068) BATTERY_MONITOR: Features: Coulomb SOC, Current-based charging, Learning persistence
I (1068) SHARED_I2C: ‚úÖ Added I2C device: address=0x36, speed=100000 Hz
I (1068) BATTERY_MONITOR: MAX17055 I2C device initialized on shared bus (address 0x36, speed 100kHz)
I (1068) BATTERY_MONITOR: ‚è±Ô∏è  Waiting 200ms for MAX17055 power stabilization...
I (1378) BATTERY_MONITOR: ‚úÖ MAX17055 communication test successful (STATUS=0x0082)
I (1378) BATTERY_MONITOR: Initializing MAX17055 fuel gauge...
I (1378) BATTERY_MONITOR: No saved parameters found, using learned defaults
I (1378) BATTERY_MONITOR: Applied learned parameters to fuel gauge
I (1378) BATTERY_MONITOR: Previous battery state loaded: Session #1, Last SOC: 100.0%
I (1378) BATTERY_MONITOR: üîç ===== FUEL GAUGE LEARNING DIAGNOSTICS =====
I (1378) BATTERY_MONITOR: üîç   FSTAT: 0x1008
I (1378) BATTERY_MONITOR: üîç     - Data Ready: YES
I (1378) BATTERY_MONITOR: üîç     - Relaxation: None
I (1378) BATTERY_MONITOR: üîç     - Full Qualified: YES
I (1378) BATTERY_MONITOR: üîç   LearnCFG: 0x0017
I (1378) BATTERY_MONITOR: üîç     - Learning Stage: 1
I (1378) BATTERY_MONITOR: üîç     - Learning Active: YES
I (1378) BATTERY_MONITOR: üîç   ModelCFG: 0x0460
I (1378) BATTERY_MONITOR: üîç     - Model ID: 6
I (1378) BATTERY_MONITOR: üîç     - Refresh: COMPLETE
I (1378) BATTERY_MONITOR: üîç ============================================
I (1388) BATTERY_MONITOR: üéØ Enabling MAX17055 learning algorithm...
I (1398) BATTERY_MONITOR: üéØ ‚úÖ Fuel gauge learning algorithm enabled successfully!
I (1398) BATTERY_MONITOR: MAX17055 initialization complete
I (1398) BATTERY_MONITOR: ‚úÖ FG_GPOUT (GPIO16) configured for MAX17055 alerts
I (1398) BATTERY_MONITOR: üîî Configuring MAX17055 SOC alert for 1% threshold...
I (1398) BATTERY_MONITOR: ‚úÖ SOC alert configured: Min=1%, Max=disabled
I (1398) BATTERY_MONITOR: ‚úÖ MAX17055 SOC alerts enabled - will trigger at 1% SOC
I (1398) BATTERY_MONITOR: Battery monitoring system initialized successfully
I (1398) recording_mode: üîã Checking critical battery protection...
I (1398) recording_mode: üîã Battery voltage: 3.373 V
I (1398) recording_mode: ‚úÖ Battery voltage OK: 3.373 V >= 2.3V
I (1398) BATTERY_MONITOR: Battery monitoring task started successfully
I (1398) BATTERY_MONITOR: Battery monitoring task started
I (1398) recording_mode: üîã Battery monitoring task started
I (1398) power_source_test: üîå Initializing power source test (TPS2117DRL control)
I (1398) power_source_test: ‚úÖ Power source test initialized (initial: BATTERY)
I (1398) led_manager: Initializing LED manager...
I (1398) neopixel: Initializing neopixel LEDs on PDM hardware (PDM_v2)
I (1398) neopixel: Boost enable pin configured and set high (normal logic)
I (1398) neopixel: Neopixel LED system initialized successfully on pin 8
I (1408) neopixel: Configured for 9 WS2812B LEDs
I (1408) led_manager: Setting initial LED state to normal operation (white)
I (1408) led_manager: Applying LED state: Normal Operation (White)
I (1408) neopixel: Stopping any running LED animation
I (1408) neopixel: LED animation stopped
I (1408) led_manager: LED manager initialized successfully (hardware available: YES)
I (1408) recording_mode: USB_SENSE (GPIO6) is HIGH
I (1408) BATTERY_MONITOR: üîç Coulomb SoC calc: REG_QH=0xFDF9 ‚Üí 32508.5 mAh ‚Üí 541.8% SoC
I (1408) recording_mode: üîÑ Creating button processing task...
I (1408) BATTERY_MONITOR: === BATTERY STATUS ===
I (1408) recording_mode: üîÑ Button processing task started
I (1408) recording_mode: Audio test disabled; skipping record/playback loop
I (1408) BATTERY_MONITOR: Present:     YES
I (1408) MFG_WIFI: üîä WiFi test disabled - initializing Bluetooth immediately...
I (1408) BATTERY_MONITOR: Voltage:     3.373 V
I (1408) BATTERY_MONITOR: USB Power:   DETECTED
I (1408) BLE_INIT: BT controller compile version [d74042a]
I (1408) BATTERY_MONITOR: Charge IC:   CHARGING IN PROGRESS (STAT1=1, STAT2=0)
I (1408) BATTERY_MONITOR: Current:     353.9 mA
I (1408) BATTERY_MONITOR: Avg Current: 360.2 mA
I (1408) BATTERY_MONITOR: SOC:         100.0%
I (1408) BATTERY_MONITOR: Temperature: 40.8¬∞C
I (1408) BATTERY_MONITOR: Cycles:      14
I (1408) BLE_INIT: Bluetooth MAC: 8c:bf:ea:84:43:c2
üì± Captured Bluetooth MAC: 8C:BF:EA:84:43:C2
I (1408) BATTERY_MONITOR: Charging:    YES
I (1408) BATTERY_MONITOR: Session:     #2
I (1408) BATTERY_MONITOR: ======================
I (1408) BATTERY_MONITOR: üîã Battery is charging (353.9 mA)
I (1408) phy_init: phy_version 700,8582a7fd,Feb 10 2025,20:13:11
I (1458) BLE_HANDLER: Bluetooth LE initialized successfully
I (1458) device_utils: Device ID initialized: 8cbfea8443c0
I (1458) device_utils: MAC Address: 8C:BF:EA:84:43:C0
I (1458) BLE_HANDLER: === CONFIGURING BLE ADVERTISING ===
I (1458) BLE_HANDLER: Setting device name to: Toy-43C0
üì± Captured Bluetooth Name: Toy-43C0
I (1468) BLE_HANDLER: BLE Advertising Configuration:
I (1468) BLE_HANDLER: üì° Service UUID: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1468) BLE_HANDLER: üì± Device Name: Toy-43C0 (in scan response)
I (1468) BLE_HANDLER: ‚è±Ô∏è  Advertising Interval: 32 - 64 (0.625ms units)
I (1468) BLE_HANDLER: üîç Discoverable: YES (General Discoverable)
I (1468) BLE_HANDLER: üì∂ TX Power: Included in scan response
I (1468) BLE_HANDLER: Service UUID bytes (little-endian):
I (1468) BLE_HANDLER: cd e8 e7 fb f1 16 0d 94 4e 47 5b ad ca 98 74 a0
I (1468) BLE_HANDLER: GATT server registered, app_id: 0000
I (1468) BLE_HANDLER: Service creation initiated successfully
I (1468) BLE_HANDLER: Service created successfully, service_handle: 40
I (1468) BLE_HANDLER: Created service with UUID: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1468) BLE_HANDLER: React Native app should look for: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1468) BLE_HANDLER: Adding characteristic: Device Info (index: 0)
I (1468) BLE_HANDLER: GATTS event: 12
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 42
I (1468) BLE_HANDLER: Adding characteristic: WiFi Config (index: 1)
I (1468) BLE_HANDLER: ‚úÖ Added CCCD descriptor for WiFi Config characteristic
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 44
I (1468) BLE_HANDLER: Adding characteristic: SSID (index: 2)
I (1468) BLE_HANDLER: ‚úÖ Added CCCD descriptor for SSID characteristic
I (1468) BLE_HANDLER: Characteristic descriptor added - handle: 45
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 47
I (1468) BLE_HANDLER: Adding characteristic: Connectivity (index: 3)
I (1468) BLE_HANDLER: Characteristic descriptor added - handle: 48
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 50
I (1468) BLE_HANDLER: Adding characteristic: Log (index: 4)
I (1468) BLE_HANDLER: ‚úÖ Added CCCD descriptor for Log characteristic
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 52
I (1468) BLE_HANDLER: Adding characteristic: QA Control (index: 5)
I (1468) BLE_HANDLER: Characteristic descriptor added - handle: 53
I (1468) BLE_HANDLER: Characteristic added successfully, char_handle: 55
I (1468) BLE_HANDLER: Adding characteristic: QA Events (index: 6)
I (1478) BLE_HANDLER: ‚úÖ Added CCCD descriptor for QA Events characteristic
I (1478) BLE_HANDLER: Characteristic added successfully, char_handle: 57
I (1478) BLE_HANDLER: Connection status changed to: ADVERTISING
I (1478) BLE_HANDLER: ‚úì BLE advertising started with optimized configuration
I (1478) BLE_HANDLER: ‚úì Service UUID in advertising data: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1478) BLE_HANDLER: ‚úì Device name in scan response: Toy-43C0
I (1478) BLE_HANDLER: ‚úì React Native app should now be able to discover this device
I (1478) BLE_HANDLER: Characteristic descriptor added - handle: 58
I (1478) BLE_HANDLER: ‚úì Advertising data configured successfully
I (1478) BLE_HANDLER: ‚úì Service UUID a07498ca-ad5b-474e-940d-16f1fbe7e8cd is now in advertising data
I (1478) BLE_HANDLER: ‚úì Scan response data set complete successfully
I (1478) BLE_HANDLER: ‚úì Device name and TX power are now in scan response
I (1478) BLE_HANDLER: üöÄ ADVERTISING STARTED SUCCESSFULLY!
I (1478) BLE_HANDLER: üîç React Native app should now be able to find this device
I (1478) BLE_HANDLER: üì± Device appears as: Toy-43C0
I (1478) BLE_HANDLER: üîó Service UUID: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1478) BLE_HANDLER: ‚ö° The device is now discoverable and ready for connection!
üöÄ BLE details captured. Auto-starting Bluetooth QC...
I (1478) BLE_HANDLER: üöÄ Starting BLE advertising process for device: Toy-43C0
I (1478) BLE_HANDLER: React Native app should look for service UUID: a07498ca-ad5b-474e-940d-16f1fbe7e8cd
I (1478) MFG_WIFI: üîä Bluetooth initialized and advertising as: Toy-43C0
I (1478) recording_mode: ‚úÖ System initialization complete - main thread exiting cleanly
I (1478) main_task: Returned from app_main()
‚ùå Bluetooth QC tester not available
‚úÖ ESP32 detected on port COM21
